<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="프로젝트 관리 시스템 - 효율적인 프로젝트 및 작업 관리 솔루션" />
    
    <!-- Google 폰트 -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
    
    <title>PMS - 프로젝트 관리 시스템</title>
    
    <style>
      /* 디버깅용 간단한 로딩 화면 */
      .debug-loading {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 10000;
        color: white;
        font-family: 'Inter', sans-serif;
        transition: opacity 0.3s ease-out;
      }
      
      .debug-loading.hidden {
        opacity: 0;
        pointer-events: none;
      }
      
      .debug-spinner {
        width: 40px;
        height: 40px;
        border: 3px solid rgba(255, 255, 255, 0.3);
        border-top: 3px solid white;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin-bottom: 20px;
      }
      
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
      
      .debug-info {
        position: fixed;
        top: 20px;
        right: 20px;
        background: rgba(0, 0, 0, 0.8);
        color: white;
        padding: 15px;
        border-radius: 8px;
        font-family: monospace;
        font-size: 12px;
        z-index: 10001;
        max-width: 300px;
      }
      
      .debug-step {
        margin: 5px 0;
        padding: 3px 0;
      }
      
      .debug-step.completed {
        color: #10b981;
      }
      
      .debug-step.error {
        color: #ef4444;
      }
      
      .debug-step.current {
        color: #f59e0b;
      }
      
      #root {
        min-height: 100vh;
        opacity: 0;
        transition: opacity 0.3s ease-in;
      }
      
      body.app-ready #root {
        opacity: 1;
      }
      
      body {
        margin: 0;
        padding: 0;
        font-family: 'Inter', sans-serif;
      }
    </style>
  </head>
  <body>
    <!-- 디버깅 정보 패널 -->
    <div id="debug-info" class="debug-info">
      <div><strong>🔧 로딩 상태 디버깅</strong></div>
      <div id="step-1" class="debug-step current">1. HTML 로드됨</div>
      <div id="step-2" class="debug-step">2. DOM 준비 완료</div>
      <div id="step-3" class="debug-step">3. React 스크립트 로드</div>
      <div id="step-4" class="debug-step">4. React 앱 렌더링</div>
      <div id="step-5" class="debug-step">5. 앱 초기화 완료</div>
      <div style="margin-top: 10px;">
        <button onclick="forceHideLoading()" style="background: #ef4444; color: white; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 11px;">
          🚨 강제 로딩 해제
        </button>
      </div>
    </div>
    
    <!-- 간단한 로딩 화면 -->
    <div id="loading-screen" class="debug-loading">
      <div class="debug-spinner"></div>
      <div style="font-size: 18px; font-weight: 500; margin-bottom: 10px;">
        🚀 PMS 로딩 중...
      </div>
      <div style="font-size: 14px; opacity: 0.8;">
        디버깅 모드로 실행 중입니다
      </div>
      <div id="loading-timer" style="font-size: 12px; margin-top: 10px; opacity: 0.6;">
        경과 시간: 0초
      </div>
    </div>

    <!-- React 앱 마운트 지점 -->
    <div id="root"></div>

    <!-- 디버깅 스크립트 -->
    <script>
      (function() {
        'use strict';
        
        let startTime = Date.now();
        let currentStep = 1;
        
        // 디버깅 로그 함수
        function debugLog(message, step) {
          console.log(`🔧 [Step ${step}] ${message}`);
          updateDebugStep(step, 'completed');
          if (step < 5) {
            updateDebugStep(step + 1, 'current');
          }
          currentStep = step + 1;
        }
        
        // 디버깅 스텝 업데이트
        function updateDebugStep(step, status) {
          const stepElement = document.getElementById(`step-${step}`);
          if (stepElement) {
            stepElement.className = `debug-step ${status}`;
            if (status === 'completed') {
              stepElement.innerHTML = stepElement.innerHTML.replace(/^\d+\./, `${step}. ✅`);
            } else if (status === 'error') {
              stepElement.innerHTML = stepElement.innerHTML.replace(/^\d+\./, `${step}. ❌`);
            } else if (status === 'current') {
              stepElement.innerHTML = stepElement.innerHTML.replace(/^\d+\./, `${step}. ⏳`);
            }
          }
        }
        
        // 타이머 업데이트
        function updateTimer() {
          const elapsed = Math.floor((Date.now() - startTime) / 1000);
          const timerElement = document.getElementById('loading-timer');
          if (timerElement) {
            timerElement.textContent = `경과 시간: ${elapsed}초`;
          }
        }
        
        // 1초마다 타이머 업데이트
        setInterval(updateTimer, 1000);
        
        // 로딩 화면 숨기기 함수
        function hideLoadingScreen() {
          try {
            debugLog('로딩 화면 숨기는 중...', 5);
            document.getElementById('loading-screen').classList.add('hidden');
            document.body.classList.add('app-ready');
            
            // 3초 후 디버그 패널 숨기기
            setTimeout(() => {
              const debugPanel = document.getElementById('debug-info');
              if (debugPanel) {
                debugPanel.style.opacity = '0.3';
                debugPanel.style.pointerEvents = 'none';
              }
            }, 3000);
            
            console.log('✅ 앱이 성공적으로 로드되었습니다!');
          } catch (error) {
            console.error('❌ 로딩 화면 숨기기 실패:', error);
            updateDebugStep(5, 'error');
          }
        }
        
        // 강제 로딩 해제 함수
        window.forceHideLoading = function() {
          console.warn('🚨 강제로 로딩 화면을 해제합니다');
          hideLoadingScreen();
        };
        
        // 전역 함수로 등록
        window.hideLoadingScreen = hideLoadingScreen;
        window.onReactReady = function() {
          debugLog('React 앱 준비 완료!', 4);
          setTimeout(hideLoadingScreen, 100);
        };
        
        // DOM 준비 완료
        if (document.readyState === 'loading') {
          document.addEventListener('DOMContentLoaded', function() {
            debugLog('DOM 준비 완료', 2);
          });
        } else {
          debugLog('DOM 준비 완료', 2);
        }
        
        // 페이지 로드 완료
        window.addEventListener('load', function() {
          debugLog('모든 리소스 로드 완료', 3);
          
          // React가 5초 내에 로드되지 않으면 경고
          setTimeout(() => {
            if (currentStep < 4) {
              console.warn('⚠️ React 앱이 5초 내에 로드되지 않았습니다');
              updateDebugStep(4, 'error');
            }
          }, 5000);
          
          // 10초 후 강제 해제
          setTimeout(() => {
            if (currentStep < 5) {
              console.warn('⚠️ 10초 타임아웃! 강제로 로딩을 해제합니다');
              hideLoadingScreen();
            }
          }, 10000);
        });
        
        // 에러 핸들링
        window.addEventListener('error', function(event) {
          console.error('❌ 윈도우 오류:', event.error);
          updateDebugStep(currentStep, 'error');
          setTimeout(hideLoadingScreen, 2000);
        });
        
        // 처리되지 않은 Promise 거부
        window.addEventListener('unhandledrejection', function(event) {
          console.error('❌ Promise 거부:', event.reason);
          updateDebugStep(currentStep, 'error');
        });
        
        debugLog('디버깅 스크립트 초기화 완료', 1);
      })();
    </script>
  </body>
</html>